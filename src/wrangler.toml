name = "robertsinfosec-freebusy-api"
main = "src/index.ts"
compatibility_date = "2024-12-18"

[dev]
ip = "0.0.0.0"
port = 8787

[vars]
# Non-secret vars can go here. Secrets are provided via `wrangler secret put`.

# v2 calendar/time semantics
CALENDAR_TIMEZONE = "America/New_York"
WINDOW_WEEKS = "4"
WEEK_START_DAY = "7"
WORKING_HOURS_JSON = "{\"weekly\":[{\"dayOfWeek\":1,\"start\":\"08:00\",\"end\":\"18:00\"},{\"dayOfWeek\":2,\"start\":\"08:00\",\"end\":\"18:00\"},{\"dayOfWeek\":3,\"start\":\"08:00\",\"end\":\"18:00\"},{\"dayOfWeek\":4,\"start\":\"08:00\",\"end\":\"18:00\"},{\"dayOfWeek\":5,\"start\":\"08:00\",\"end\":\"18:00\"}]}"

# Safety limits / caching
CACHE_TTL_SECONDS = "60"
UPSTREAM_MAX_BYTES = "1572864"

FREEBUSY_ENABLED = "true"
CORS_ALLOWLIST = "https://freebusy.robertsinfosec.com"
RATE_LIMIT_WINDOW_MS = "300000"
RATE_LIMIT_MAX = "60"
RATE_LIMIT_GLOBAL_WINDOW_MS = "300000"
RATE_LIMIT_GLOBAL_MAX = "500"

[[durable_objects.bindings]]
name = "RATE_LIMITER"
class_name = "RateLimitDurable"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["RateLimitDurable"]

[observability]
[observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true
persist = true
